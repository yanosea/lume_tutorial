@import "tailwindcss";
@plugin "@tailwindcss/typography";
@source "./**/*.{tsx,mdx}";

/* ============================================================================
   Configuration
   ============================================================================ */

@variant dark (&:is(.dark *));

@view-transition {
  navigation: auto;
}

/* ============================================================================
   Base Styles
   ============================================================================ */

/*
 * PlemolJP Font
 * Copyright (c) 2021 Yuko OTAWARA
 * Licensed under SIL Open Font License 1.1
 * https://github.com/yuru7/PlemolJP
 *
 * This font is based on:
 * - IBM Plex Mono (SIL OFL 1.1) - Copyright IBM Corp.
 * - IBM Plex Sans JP (SIL OFL 1.1) - Copyright IBM Corp.
 */
@font-face {
  font-family: "PlemolJP";
  src: url("/assets/fonts/PlemolJP-Regular.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

/* ============================================================================
   Everforest Color Palette
   Based on: https://github.com/sainnhe/everforest
   A comfortable & pleasant color scheme designed to protect developers' eyes.
   ============================================================================ */

@theme {
  /* Everforest Dark Palette (Medium variant - recommended default) */
  --color-dark-bg-dim: #232a2e;
  --color-dark-bg0: #2d353b;
  --color-dark-bg1: #343f44;
  --color-dark-bg2: #3d484d;
  --color-dark-bg3: #475258;
  --color-dark-bg4: #4f585e;
  --color-dark-bg5: #56635f;
  --color-dark-bg-visual: #543a48;
  --color-dark-bg-red: #514045;
  --color-dark-bg-green: #425047;
  --color-dark-bg-blue: #3a515d;
  --color-dark-bg-yellow: #4d4c43;
  --color-dark-bg-purple: #4a444e;

  --color-dark-fg: #d3c6aa;
  --color-dark-red: #e67e80;
  --color-dark-orange: #e69875;
  --color-dark-yellow: #dbbc7f;
  --color-dark-green: #a7c080;
  --color-dark-aqua: #83c092;
  --color-dark-blue: #7fbbb3;
  --color-dark-purple: #d699b6;

  --color-dark-grey0: #7a8478;
  --color-dark-grey1: #859289;
  --color-dark-grey2: #9da9a0;

  --color-dark-statusline1: #a7c080;
  --color-dark-statusline2: #d3c6aa;
  --color-dark-statusline3: #e67e80;

  /* Everforest Light Palette (Medium variant - recommended default) */
  --color-light-bg-dim: #efebd4;
  --color-light-bg0: #fdf6e3;
  --color-light-bg1: #f4f0d9;
  --color-light-bg2: #efebd4;
  --color-light-bg3: #e6e2cc;
  --color-light-bg4: #e0dcc7;
  --color-light-bg5: #bdc3af;
  --color-light-bg-visual: #eaedc8;
  --color-light-bg-red: #fce5dc;
  --color-light-bg-green: #f1f3d4;
  --color-light-bg-blue: #eaf2eb;
  --color-light-bg-yellow: #faedcd;
  --color-light-bg-purple: #f9e7e4;

  --color-light-fg: #5c6a72;
  --color-light-red: #f85552;
  --color-light-orange: #f57d26;
  --color-light-yellow: #dfa000;
  --color-light-green: #8da101;
  --color-light-aqua: #35a77c;
  --color-light-blue: #3a94c5;
  --color-light-purple: #df69ba;

  --color-light-grey0: #a6b0a0;
  --color-light-grey1: #939f91;
  --color-light-grey2: #829181;

  --color-light-statusline1: #93b259;
  --color-light-statusline2: #708089;
  --color-light-statusline3: #e66868;
}

:root {
  /* Font System */
  --font-family-base:
    PlemolJP, sans-serif, system-ui, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";

  /* Semantic Color Mappings - Light Mode (Default) */
  --color-bg-primary: var(--color-light-bg0);
  --color-bg-secondary: var(--color-light-bg1);
  --color-bg-elevated: var(--color-light-bg2);
  --color-bg-dim: var(--color-light-bg-dim);

  --color-fg-primary: var(--color-light-fg);
  --color-fg-secondary: var(--color-light-grey1);
  --color-fg-muted: var(--color-light-grey2);

  --color-border-primary: var(--color-light-bg4);
  --color-border-secondary: var(--color-light-bg3);

  --color-accent-primary: var(--color-light-green);
  --color-accent-blue: var(--color-light-blue);
  --color-accent-red: var(--color-light-red);
  --color-accent-yellow: var(--color-light-yellow);
  --color-accent-purple: var(--color-light-purple);
  --color-accent-aqua: var(--color-light-aqua);

  --color-card-bg: var(--color-light-bg1);
  --color-card-border: var(--color-light-bg3);
  --color-card-hover-bg: var(--color-light-bg2);
  --color-card-hover-border: var(--color-light-bg4);

  /* Transition Durations */
  --transition-fast: 150ms;
  --transition-normal: 300ms;

  /* Transition Timing */
  --ease-smooth: ease-in-out;

  /* Transition Shorthand */
  --transition-color: color var(--transition-fast) var(--ease-smooth);
  --transition-opacity: opacity var(--transition-fast) var(--ease-smooth);
  --transition-bg-border: background-color var(--transition-fast) var(--ease-smooth),
                         border-color var(--transition-fast) var(--ease-smooth);
  --transition-card: background-color var(--transition-fast) var(--ease-smooth),
                    border-color var(--transition-fast) var(--ease-smooth),
                    box-shadow var(--transition-fast) var(--ease-smooth);

  /* Layout */
  --header-footer-height: 5rem;
  --toc-top-offset: 6rem;
}

/* Dark Mode Semantic Color Mappings */
.dark {
  --color-bg-primary: var(--color-dark-bg0);
  --color-bg-secondary: var(--color-dark-bg1);
  --color-bg-elevated: var(--color-dark-bg2);
  --color-bg-dim: var(--color-dark-bg-dim);

  --color-fg-primary: var(--color-dark-fg);
  --color-fg-secondary: var(--color-dark-grey1);
  --color-fg-muted: var(--color-dark-grey2);

  --color-border-primary: var(--color-dark-bg4);
  --color-border-secondary: var(--color-dark-bg3);

  --color-accent-primary: var(--color-dark-green);
  --color-accent-blue: var(--color-dark-blue);
  --color-accent-red: var(--color-dark-red);
  --color-accent-yellow: var(--color-dark-yellow);
  --color-accent-purple: var(--color-dark-purple);
  --color-accent-aqua: var(--color-dark-aqua);

  --color-card-bg: var(--color-dark-bg1);
  --color-card-border: var(--color-dark-bg3);
  --color-card-hover-bg: var(--color-dark-bg2);
  --color-card-hover-border: var(--color-dark-bg4);
}

@media (prefers-reduced-motion: reduce) {
  :root {
    --transition-fast: 0ms;
    --transition-normal: 0ms;
  }
}

html {
  overflow-y: scroll;
  scroll-behavior: smooth;
  font-family: var(--font-family-base);
  background-color: var(--color-bg-primary);
  color: var(--color-fg-primary);
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
}

/* ============================================================================
   View Transitions
   ============================================================================ */

/* Smooth cross-fade animation for all page transitions */
::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: var(--transition-normal);
  animation-timing-function: var(--ease-smooth);
}

@media (prefers-reduced-motion: reduce) {
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none;
  }
}

/* ============================================================================
   Layout Components
   ============================================================================ */

/* Card containers */
.card {
  @apply p-8 rounded-lg shadow-xl;
  background-color: var(--color-card-bg);
  border: 1px solid var(--color-card-border);
  transition: var(--transition-card);
  contain: layout style paint;
  content-visibility: auto;
}

.card-article {
  @apply p-6 border rounded-lg;
  background-color: var(--color-card-bg);
  border-color: var(--color-card-border);
  transition: var(--transition-card);
  will-change: background-color, border-color, box-shadow;
  contain: layout style paint;
}

.card-article:not(:hover) {
  will-change: auto;
}

.card-article:hover {
  background-color: var(--color-card-hover-bg);
  border-color: var(--color-card-hover-border);
  @apply shadow-md;
}

/* Improve link visibility on card hover */
.card-article:hover .link-primary {
  color: var(--color-accent-blue);
}

/* Table of Contents card */
.card-toc {
  @apply px-6 py-4 border rounded-lg;
  background-color: var(--color-card-bg);
  border-color: var(--color-card-border);
  transition: var(--transition-bg-border);
}

.card-toc > h2:first-child {
  margin: 0 0 1rem 0;
}

.card-toc ol {
  margin: 0;
}

.card-toc li:last-child {
  margin-bottom: 0;
}

/* ============================================================================
   Typography
   ============================================================================ */

/* Page heading */
.heading-page {
  @apply mb-6 text-3xl font-bold leading-normal;
  color: var(--color-fg-primary);
}

/* ============================================================================
   Utility Classes - Color & Background
   ============================================================================ */

/* Text color variants */
.text-primary {
  color: var(--color-fg-primary);
}

.text-secondary {
  color: var(--color-fg-secondary);
}

.text-muted {
  color: var(--color-fg-muted);
}

/* Background variants */
.bg-primary {
  background-color: var(--color-bg-primary);
}

.bg-secondary {
  background-color: var(--color-bg-secondary);
}

.bg-elevated {
  background-color: var(--color-bg-elevated);
}

/* Border variants */
.border-primary {
  border-color: var(--color-border-primary);
}

.border-secondary {
  border-color: var(--color-border-secondary);
}

/* ============================================================================
   Accessibility - Skip Link
   ============================================================================ */

.skip-link:focus {
  background-color: var(--color-accent-primary);
  color: var(--color-light-bg0);
  border-color: var(--color-accent-aqua);
}

/* ============================================================================
   Header & Footer
   ============================================================================ */

/* Sticky header with solid background */
header {
  background-color: var(--color-bg-primary);
  backdrop-filter: blur(8px);
}

/* ============================================================================
   Links and Navigation
   ============================================================================ */

/* Primary link style */
.link-primary {
  color: var(--color-accent-blue);
  transition: var(--transition-color);
  text-decoration-skip-ink: auto;
}

.link-primary:hover {
  color: var(--color-accent-aqua);
}

/* Header navigation links */
.nav-link {
  color: var(--color-fg-secondary);
  transition: var(--transition-color);
  text-decoration-skip-ink: auto;
}

.nav-link:hover {
  color: var(--color-accent-primary);
}

/* Interactive elements with opacity transition */
.header-logo-link,
.hamburger-button {
  transition: var(--transition-opacity);
}

.header-logo-link:hover,
.hamburger-button:hover {
  opacity: 0.8;
}

/* Hamburger menu icon */
.hamburger-icon {
  transition: var(--transition-opacity);
}

/* Theme toggle button */
.theme-toggle-button {
  transition: var(--transition-opacity);
}

.theme-toggle-button:hover {
  opacity: 0.8;
}

/* Link card title - override prose styles */
.link-card-title {
  transition: var(--transition-color);
  text-decoration-skip-ink: auto;
}

/* ============================================================================
   Tags
   ============================================================================ */

/* Default tag style */
.tag {
  @apply px-2 py-1 text-xs rounded border;
  color: var(--color-fg-secondary);
  background-color: var(--color-bg-elevated);
  border-color: var(--color-border-secondary);
  transition: var(--transition-bg-border), var(--transition-color);
}

.tag:hover {
  background-color: var(--color-bg-secondary);
  border-color: var(--color-border-primary);
  color: var(--color-fg-primary);
}

/* Active/selected tag */
.tag-active {
  @apply px-2 py-1 text-xs font-medium rounded border;
  color: var(--color-accent-primary);
  background-color: var(--color-light-bg-green);
  border-color: var(--color-accent-primary);
  transition: var(--transition-bg-border), var(--transition-color);
}

.dark .tag-active {
  background-color: var(--color-dark-bg-green);
}

.tag-active:hover {
  filter: brightness(1.1);
}

/* ============================================================================
   Prose Content (MDX/Markdown)
   ============================================================================ */

/* --- Headings --- */

.prose-content h1,
.prose-content h2,
.prose-content h3,
.prose-content h4,
.prose-content h5,
.prose-content h6 {
  font-weight: bold;
  color: var(--color-fg-primary);
  scroll-margin-top: var(--toc-top-offset);
}

.prose-content h1 {
  font-size: 1.875rem;
  margin-bottom: 1.5rem;
}

.prose-content h2 {
  font-size: 1.5rem;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

.prose-content h3 {
  font-size: 1.25rem;
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}

/* --- Text content --- */

.prose-content p {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  line-height: 1.75;
}

.prose-content strong {
  font-weight: bold;
}

/* --- Lists --- */

/* Apply list styles only to actual content lists, excluding utility lists like tags */
.prose-content ul:not(.list-none),
.prose-content ol:not(.list-none) {
  margin-top: 1rem;
  margin-bottom: 1rem;
  padding-left: 1.5rem;
}

.prose-content li {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

/* --- Links --- */

.prose-content a {
  color: var(--color-accent-blue);
  text-decoration: none;
  transition: var(--transition-color);
}

.prose-content a:hover {
  color: var(--color-accent-aqua);
}

/* Override prose link styles for tags */
.prose-content .tag,
.prose-content .tag-active {
  text-decoration: none;
}

.prose-content .tag {
  color: var(--color-fg-secondary);
}

.prose-content .tag:hover {
  color: var(--color-fg-primary);
  background-color: var(--color-bg-secondary);
}

.prose-content .tag-active {
  color: var(--color-accent-primary);
}

.prose-content .tag-active:hover {
  filter: brightness(1.1);
}

/* --- Code --- */

/* Code blocks (must come before inline code for proper specificity) */
.prose-content pre {
  background-color: var(--color-dark-bg0);
  color: var(--color-dark-fg);
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  margin-top: 1rem;
  margin-bottom: 1rem;
  contain: layout style paint;
  -webkit-overflow-scrolling: touch;
}

.prose-content pre code {
  background-color: transparent;
  padding: 0;
  color: inherit;
}

/* Inline code */
.prose-content :not(pre) > code {
  background-color: var(--color-bg-elevated);
  color: var(--color-fg-primary);
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
  font-size: 0.875rem;
}

/* Code highlight theme placeholder */
/* insert-code-theme */

/* --- Tables --- */

.prose-content table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
  margin-bottom: 1rem;
  overflow-x: auto;
  display: block;
  -webkit-overflow-scrolling: touch;
}

.prose-content tbody,
.prose-content thead {
  display: table;
  width: 100%;
}

.prose-content th,
.prose-content td {
  border: 1px solid var(--color-border-secondary);
  padding: 0.5rem;
  text-align: left;
}

.prose-content th {
  background-color: var(--color-bg-elevated);
  font-weight: 600;
}

/* ============================================================================
   FOUC Prevention - Must be at the end of the file
   ============================================================================ */

html {
  visibility: visible !important;
  opacity: 1 !important;
}
